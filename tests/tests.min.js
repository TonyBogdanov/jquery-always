"use strict";!function(e,a){var n,t,o,s,r=function(){function e(e){this.invoked=0,this.callback=e}return e.prototype.invoke=function(){this.callback.apply(this,arguments),this.invoked++},e.prototype.getInvoked=function(){return this.invoked},e}(),i=function(){function e(){}return e.createCallbacks=function(){return{a:new r(function(){}),b:new r(function(){}),div:new r(function(){})}},e.invokeCallbacks=function(e){return function(){e[this.tagName.toLowerCase()].invoke()}},e.assertInvoked=function(e,n,t,o,s){a.equal(e.a.getInvoked(),n,(s?s+": ":"")+"Callback #a must be invoked "+n+" time(s) total"),a.equal(e.b.getInvoked(),t,(s?s+": ":"")+"Callback #b must be invoked "+t+" time(s) total"),a.equal(e.div.getInvoked(),o,(s?s+": ":"")+"Callback #div must be invoked "+o+" time(s) total")},e.wait=function(a,n){0>=a?n():"function"==typeof window.requestAnimationFrame?requestAnimationFrame(function(){e.wait(a-1,n)}):setTimeout(function(){e.wait(a-1,n)},1e3/60)},e}();beforeEach(function(){n=e("<div/>"),t=e("<a/>"),o=e("<b/>"),s=e("<div/>"),e(document.body).append(n)}),afterEach(function(){n.remove()}),describe("jQuery.Always",function(){it("Dependencies have resolved",function(){var e=typeof MutationObserver,n=typeof WebKitMutationObserver;a.isTrue("undefined"!==e||"undefined"!==n,"Browser must support mutation observer feature, typeof MutationObserver is "+e+", typeof WebKitMutationObserver is "+n)}),it("Plugin has registered",function(){a.isFunction(e.fn.always,"always() must be registered with jQuery"),a.isFunction(e.fn.never,"never() must be registered with jQuery")}),it('"Inserted" callbacks are executed for matching selectors (before registration)',function(e){var a=i.createCallbacks();n.append(t).append(o).append(s).always("a, b",i.invokeCallbacks(a)),i.wait(1,function(){i.assertInvoked(a,1,1,0),e()})}),it('"Inserted" callbacks are executed for matching selectors (after registration)',function(e){var a=i.createCallbacks();n.always("a, b",i.invokeCallbacks(a)).append(t).append(o).append(s),i.wait(1,function(){i.assertInvoked(a,1,1,0),e()})}),it('"Removed" callbacks are executed for matching selectors',function(e){var a=i.createCallbacks();n.append(t).append(o).append(s).always("a, b",void 0,i.invokeCallbacks(a)),t.remove(),o.remove(),i.wait(1,function(){i.assertInvoked(a,1,1,0),e()})}),it("Callbacks are also executed for selectors matching children (deep) of mutated elements",function(a){var r=i.createCallbacks(),c=i.createCallbacks(),l=e("<span/>"),d=e("<span/>"),v=e("<span/>");l.append(e("<span/>").append(t.clone()).append(e("<span/>").append(t.clone()))),d.append(e("<span/>").append(o.clone()).append(e("<span/>").append(o.clone()))),v.append(e("<span/>").append(s.clone()).append(e("<span/>").append(s.clone()))),n.always("a, b",i.invokeCallbacks(r),i.invokeCallbacks(c)).append(l).append(d).append(v),i.wait(1,function(){i.assertInvoked(r,2,2,0),i.assertInvoked(c,0,0,0),l.children().children().last().remove(),d.remove(),v.remove(),i.wait(1,function(){i.assertInvoked(r,2,2,0),i.assertInvoked(c,1,2,0),a()})})}),it("Calling never() stops execution of all callbacks",function(e){var a=i.createCallbacks(),r=i.createCallbacks();n.always("a, b",i.invokeCallbacks(a),i.invokeCallbacks(r)).append(t).append(o).append(s),i.wait(1,function(){i.assertInvoked(a,1,1,0,"Pre-Never (Inserted)"),t.remove(),o.remove(),s.remove(),i.wait(1,function(){i.assertInvoked(r,1,1,0,"Pre-Never (Removed)"),n.never().append(t).append(o).append(s),i.wait(1,function(){i.assertInvoked(a,1,1,0,"Post-Never (Inserted)"),t.remove(),o.remove(),s.remove(),i.wait(1,function(){i.assertInvoked(r,1,1,0,"Post-Never (Removed)"),e()})})})})}),it("Calling never(selector) stops execution of matching callbacks",function(e){var a=i.createCallbacks(),r=i.createCallbacks();n.always("a, b",i.invokeCallbacks(a)).always("div",i.invokeCallbacks(r)).append(t).append(o).append(s),i.wait(1,function(){i.assertInvoked(a,1,1,0,"Pre-Never (A,B)"),i.assertInvoked(r,0,0,1,"Pre-Never (DIV)"),t.remove(),o.remove(),s.remove(),n.never("b,a").append(t).append(o).append(s),i.wait(1,function(){i.assertInvoked(a,1,1,0,"Post-Never (A,B)"),i.assertInvoked(r,0,0,2,"Post-Never (DIV)"),e()})})}),it("Calling never(selector, insertedCallback, removedCallback) stops execution of exact callback(s)",function(e){var a=i.createCallbacks(),r=i.createCallbacks(),c=i.createCallbacks(),l=i.invokeCallbacks(a),d=i.invokeCallbacks(r),v=i.invokeCallbacks(c);n.always("a",l).always("b",d).always("div",void 0,v).append(t).append(o).append(s),s.remove(),i.wait(1,function(){i.assertInvoked(a,1,0,0,"Pre-Never (A)"),i.assertInvoked(r,0,1,0,"Pre-Never (B)"),i.assertInvoked(c,0,0,1,"Pre-Never (DIV)"),t.remove(),o.remove(),n.never("a",l).append(t).append(o).append(s),s.remove(),i.wait(1,function(){i.assertInvoked(a,1,0,0,"Post-Never (A)"),i.assertInvoked(r,0,2,0,"Post-Never (B)"),i.assertInvoked(c,0,0,2,"Post-Never (DIV)"),t.remove(),o.remove(),n.never("div",void 0,v).append(t).append(o).append(s),s.remove(),i.wait(1,function(){i.assertInvoked(a,1,0,0,"Post-Never (A)"),i.assertInvoked(r,0,3,0,"Post-Never (B)"),i.assertInvoked(c,0,0,2,"Post-Never (DIV)"),e()})})})}),it('Adding a second "inserted" callback eligible for immediate execution does not trigger re-execution of the first one',function(e){var a=i.createCallbacks();n.append(t.attr("data-ab","")).append(o.attr("data-ab","")).append(s).always("a",i.invokeCallbacks(a)).always("[data-ab]",i.invokeCallbacks(a)),i.wait(1,function(){i.assertInvoked(a,2,1,0),e()})})})}(jQuery,chai.assert);
//# sourceMappingURL=tests.min.js.map