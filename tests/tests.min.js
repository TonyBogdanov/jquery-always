!function(e,a){"use strict";!function(e,a){var t,n,o,s,r=function(){function e(e){this.invoked=0,this.callback=e}return e.prototype.invoke=function(){this.callback.apply(this,arguments),this.invoked++},e.prototype.getInvoked=function(){return this.invoked},e}(),i=function(){function e(){}return e.createCallbacks=function(){return{a:new r(function(){}),b:new r(function(){}),div:new r(function(){})}},e.invokeCallbacks=function(e){return function(){e[this.tagName.toLowerCase()].invoke()}},e.assertInvoked=function(e,t,n,o,s){a.equal(e.a.getInvoked(),t,(s?s+": ":"")+"Callback #a must be invoked "+t+" time(s) total"),a.equal(e.b.getInvoked(),n,(s?s+": ":"")+"Callback #b must be invoked "+n+" time(s) total"),a.equal(e.div.getInvoked(),o,(s?s+": ":"")+"Callback #div must be invoked "+o+" time(s) total")},e.wait=function(a,t){a<=0?t():setTimeout(function(){e.wait(a-1,t)},1)},e}();beforeEach(function(){t=e("<div/>"),n=e("<a/>"),o=e("<b/>"),s=e("<div/>"),e(document.body).append(t)}),afterEach(function(){t.remove()});var l=!!window.MSInputMethodContext&&!!document.documentMode;describe("jQuery.Always",function(){it("Dependencies have resolved",function(){var e=typeof window.MutationObserver,t=typeof window.WebKitMutationObserver;a.isTrue("undefined"!==e||"undefined"!==t,"Browser must support mutation observer feature, typeof MutationObserver is "+e+", typeof WebKitMutationObserver is "+t)}),it("Plugin has registered",function(){a.isFunction(e.fn.always,"always() must be registered with jQuery"),a.isFunction(e.fn.never,"never() must be registered with jQuery")}),it('"Inserted" callbacks are executed for matching selectors (before registration)',function(e){var a=i.createCallbacks();t.append(n).append(o).append(s).always("a, b",i.invokeCallbacks(a)),i.wait(1,function(){i.assertInvoked(a,1,1,0),e()})}),it('"Inserted" callbacks are executed for matching selectors (after registration)',function(e){var a=i.createCallbacks();t.always("a, b",i.invokeCallbacks(a)).append(n).append(o).append(s),i.wait(1,function(){i.assertInvoked(a,1,1,0),e()})}),it('"Removed" callbacks are executed for matching selectors',function(e){var a=i.createCallbacks();t.append(n).append(o).append(s).always("a, b",void 0,i.invokeCallbacks(a)),n.remove(),o.remove(),i.wait(1,function(){i.assertInvoked(a,1,1,0),e()})}),(l?it.skip:it)('"Removed" callbacks are also executed for selectors matching children (deep) of mutated elements',function(e){var a=i.createCallbacks();t.always("a, b",null,i.invokeCallbacks(a)).append("<a></a><a><b></b></a><a></a><b></b><div><a></a><a><b></b></a><b></b></div>"),i.wait(1,function(){i.assertInvoked(a,0,0,0),t.html(""),i.wait(1,function(){i.assertInvoked(a,5,4,0),e()})})}),it("Callbacks are not called multiple times for special cases (like wrap()) where the element is already in the Dom",function(e){var a=i.createCallbacks(),o=i.createCallbacks();t.append(n).always("a",i.invokeCallbacks(a),i.invokeCallbacks(o)),i.wait(1,function(){i.assertInvoked(a,1,0,0),i.assertInvoked(o,0,0,0),n.wrap("<div/>"),i.wait(1,function(){i.assertInvoked(a,2,0,0),i.assertInvoked(o,1,0,0),e()})})}),it("Callbacks are not called multiple times for special cases (like wrap() / unwrap()) where child nodes are also reported as mutated",function(a){var o=i.createCallbacks(),s=i.createCallbacks(),r=e("<span/>");t.always("a",i.invokeCallbacks(o),i.invokeCallbacks(s)).append(n),i.wait(1,function(){i.assertInvoked(o,1,0,0),i.assertInvoked(s,0,0,0),n.wrap(r),i.wait(1,function(){i.assertInvoked(o,2,0,0),i.assertInvoked(s,1,0,0),n.unwrap(),i.wait(1,function(){i.assertInvoked(o,3,0,0),i.assertInvoked(s,2,0,0),a()})})})}),it("Calling never() stops execution of all callbacks",function(e){var a=i.createCallbacks(),r=i.createCallbacks();t.always("a, b",i.invokeCallbacks(a),i.invokeCallbacks(r)).append(n).append(o).append(s),i.wait(1,function(){i.assertInvoked(a,1,1,0,"Pre-Never (Inserted)"),n.remove(),o.remove(),s.remove(),i.wait(1,function(){i.assertInvoked(r,1,1,0,"Pre-Never (Removed)"),t.never().append(n).append(o).append(s),i.wait(1,function(){i.assertInvoked(a,1,1,0,"Post-Never (Inserted)"),n.remove(),o.remove(),s.remove(),i.wait(1,function(){i.assertInvoked(r,1,1,0,"Post-Never (Removed)"),e()})})})})}),it("Calling never(selector) stops execution of matching callbacks",function(e){var a=i.createCallbacks(),r=i.createCallbacks();t.always("a, b",i.invokeCallbacks(a)).always("div",i.invokeCallbacks(r)).append(n).append(o).append(s),i.wait(1,function(){i.assertInvoked(a,1,1,0,"Pre-Never (A,B)"),i.assertInvoked(r,0,0,1,"Pre-Never (DIV)"),n.remove(),o.remove(),s.remove(),t.never("b,a").append(n).append(o).append(s),i.wait(1,function(){i.assertInvoked(a,1,1,0,"Post-Never (A,B)"),i.assertInvoked(r,0,0,2,"Post-Never (DIV)"),e()})})}),it("Calling never(selector, insertedCallback, removedCallback) stops execution of exact callback(s)",function(e){var a=i.createCallbacks(),r=i.createCallbacks(),l=i.createCallbacks(),c=i.invokeCallbacks(a),d=i.invokeCallbacks(r),v=i.invokeCallbacks(l);t.always("a",c).always("b",d).always("div",void 0,v).append(n).append(o).append(s),s.remove(),i.wait(1,function(){i.assertInvoked(a,1,0,0,"Pre-Never (A)"),i.assertInvoked(r,0,1,0,"Pre-Never (B)"),i.assertInvoked(l,0,0,1,"Pre-Never (DIV)"),n.remove(),o.remove(),t.never("a",c).append(n).append(o).append(s),s.remove(),i.wait(1,function(){i.assertInvoked(a,1,0,0,"Post-Never (A)"),i.assertInvoked(r,0,2,0,"Post-Never (B)"),i.assertInvoked(l,0,0,2,"Post-Never (DIV)"),n.remove(),o.remove(),t.never("div",void 0,v).append(n).append(o).append(s),s.remove(),i.wait(1,function(){i.assertInvoked(a,1,0,0,"Post-Never (A)"),i.assertInvoked(r,0,3,0,"Post-Never (B)"),i.assertInvoked(l,0,0,2,"Post-Never (DIV)"),e()})})})}),it('Adding a second "inserted" callback eligible for immediate execution does not trigger re-execution of the first one',function(e){var a=i.createCallbacks();t.append(n.attr("data-ab","")).append(o.attr("data-ab","")).append(s).always("a",i.invokeCallbacks(a)).always("[data-ab]",i.invokeCallbacks(a)),i.wait(1,function(){i.assertInvoked(a,2,1,0),e()})}),it("Issuing multiple additions / removals invokes registered callbacks in a reasonable amount of time",function(e){var n=1e3,o=0,s=0,r=function(){if(o+=(new Date).getTime()-s,0==n--)return a.isBelow(o,1e3),e();var r=t.find("a, em, strong, span, div"),i=0<r.length&&.5>Math.random()?function(){return r.first().remove()}:function(){return t.append("<"+["a","em","strong","span","div"][Math.round(4*Math.random())]+"/>")};s=(new Date).getTime(),i()};t.always("a, em, strong, span, div",r,r),s=(new Date).getTime(),r()})})}(e=e&&e.hasOwnProperty("default")?e.default:e,(a=a&&a.hasOwnProperty("default")?a.default:a).assert)}(jQuery,chai);
//# sourceMappingURL=tests.min.js.map