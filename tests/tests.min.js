!function(e,a){"use strict";var n,t,o,s,r,i,c,l;e=e&&e.hasOwnProperty("default")?e.default:e,a=a&&a.hasOwnProperty("default")?a.default:a,n=e,t=a.assert,c=function(){function e(e){this.invoked=0,this.callback=e}return e.prototype.invoke=function(){this.callback.apply(this,arguments),this.invoked++},e.prototype.getInvoked=function(){return this.invoked},e}(),l=function(){function e(){}return e.createCallbacks=function(){return{a:new c(function(){}),b:new c(function(){}),div:new c(function(){})}},e.invokeCallbacks=function(e){return function(){e[this.tagName.toLowerCase()].invoke()}},e.assertInvoked=function(e,a,n,o,s){t.equal(e.a.getInvoked(),a,(s?s+": ":"")+"Callback #a must be invoked "+a+" time(s) total"),t.equal(e.b.getInvoked(),n,(s?s+": ":"")+"Callback #b must be invoked "+n+" time(s) total"),t.equal(e.div.getInvoked(),o,(s?s+": ":"")+"Callback #div must be invoked "+o+" time(s) total")},e.wait=function(a,n){a<=0?n():setTimeout(function(){e.wait(a-1,n)},1)},e}(),beforeEach(function(){o=n("<div/>"),s=n("<a/>"),r=n("<b/>"),i=n("<div/>"),n(document.body).append(o)}),afterEach(function(){o.remove()}),describe("jQuery.Always",function(){it("Dependencies have resolved",function(){var e=typeof window.MutationObserver,a=typeof window.WebKitMutationObserver;t.isTrue("undefined"!==e||"undefined"!==a,"Browser must support mutation observer feature, typeof MutationObserver is "+e+", typeof WebKitMutationObserver is "+a)}),it("Plugin has registered",function(){t.isFunction(n.fn.always,"always() must be registered with jQuery"),t.isFunction(n.fn.never,"never() must be registered with jQuery")}),it('"Inserted" callbacks are executed for matching selectors (before registration)',function(e){var a=l.createCallbacks();o.append(s).append(r).append(i).always("a, b",l.invokeCallbacks(a)),l.wait(1,function(){l.assertInvoked(a,1,1,0),e()})}),it('"Inserted" callbacks are executed for matching selectors (after registration)',function(e){var a=l.createCallbacks();o.always("a, b",l.invokeCallbacks(a)).append(s).append(r).append(i),l.wait(1,function(){l.assertInvoked(a,1,1,0),e()})}),it('"Removed" callbacks are executed for matching selectors',function(e){var a=l.createCallbacks();o.append(s).append(r).append(i).always("a, b",void 0,l.invokeCallbacks(a)),s.remove(),r.remove(),l.wait(1,function(){l.assertInvoked(a,1,1,0),e()})}),it("Callbacks are also executed for selectors matching children (deep) of mutated elements",function(e){var a=l.createCallbacks(),n=l.createCallbacks();o.always("a, b",l.invokeCallbacks(a),l.invokeCallbacks(n)).append("<a></a><a><b></b></a><a></a><b></b><div><a></a><a><b></b></a><b></b></div>"),l.wait(1,function(){l.assertInvoked(a,5,4,0),l.assertInvoked(n,0,0,0),o.html(""),l.wait(1,function(){l.assertInvoked(a,5,4,0),l.assertInvoked(n,5,4,0),e()})})}),it("Callbacks are not called multiple times for special cases (like wrap() / unwrap()) where child nodes are also reported as mutated",function(e){var a=l.createCallbacks(),t=l.createCallbacks(),r=n("<span/>");o.always("a",l.invokeCallbacks(a),l.invokeCallbacks(t)).append(s),l.wait(1,function(){l.assertInvoked(a,1,0,0),l.assertInvoked(t,0,0,0),s.wrap(r),l.wait(1,function(){l.assertInvoked(a,2,0,0),l.assertInvoked(t,1,0,0),s.unwrap(),l.wait(1,function(){l.assertInvoked(a,3,0,0),l.assertInvoked(t,2,0,0),e()})})})}),it("Calling never() stops execution of all callbacks",function(e){var a=l.createCallbacks(),n=l.createCallbacks();o.always("a, b",l.invokeCallbacks(a),l.invokeCallbacks(n)).append(s).append(r).append(i),l.wait(1,function(){l.assertInvoked(a,1,1,0,"Pre-Never (Inserted)"),s.remove(),r.remove(),i.remove(),l.wait(1,function(){l.assertInvoked(n,1,1,0,"Pre-Never (Removed)"),o.never().append(s).append(r).append(i),l.wait(1,function(){l.assertInvoked(a,1,1,0,"Post-Never (Inserted)"),s.remove(),r.remove(),i.remove(),l.wait(1,function(){l.assertInvoked(n,1,1,0,"Post-Never (Removed)"),e()})})})})}),it("Calling never(selector) stops execution of matching callbacks",function(e){var a=l.createCallbacks(),n=l.createCallbacks();o.always("a, b",l.invokeCallbacks(a)).always("div",l.invokeCallbacks(n)).append(s).append(r).append(i),l.wait(1,function(){l.assertInvoked(a,1,1,0,"Pre-Never (A,B)"),l.assertInvoked(n,0,0,1,"Pre-Never (DIV)"),s.remove(),r.remove(),i.remove(),o.never("b,a").append(s).append(r).append(i),l.wait(1,function(){l.assertInvoked(a,1,1,0,"Post-Never (A,B)"),l.assertInvoked(n,0,0,2,"Post-Never (DIV)"),e()})})}),it("Calling never(selector, insertedCallback, removedCallback) stops execution of exact callback(s)",function(e){var a=l.createCallbacks(),n=l.createCallbacks(),t=l.createCallbacks(),c=l.invokeCallbacks(a),d=l.invokeCallbacks(n),v=l.invokeCallbacks(t);o.always("a",c).always("b",d).always("div",void 0,v).append(s).append(r).append(i),i.remove(),l.wait(1,function(){l.assertInvoked(a,1,0,0,"Pre-Never (A)"),l.assertInvoked(n,0,1,0,"Pre-Never (B)"),l.assertInvoked(t,0,0,1,"Pre-Never (DIV)"),s.remove(),r.remove(),o.never("a",c).append(s).append(r).append(i),i.remove(),l.wait(1,function(){l.assertInvoked(a,1,0,0,"Post-Never (A)"),l.assertInvoked(n,0,2,0,"Post-Never (B)"),l.assertInvoked(t,0,0,2,"Post-Never (DIV)"),s.remove(),r.remove(),o.never("div",void 0,v).append(s).append(r).append(i),i.remove(),l.wait(1,function(){l.assertInvoked(a,1,0,0,"Post-Never (A)"),l.assertInvoked(n,0,3,0,"Post-Never (B)"),l.assertInvoked(t,0,0,2,"Post-Never (DIV)"),e()})})})}),it('Adding a second "inserted" callback eligible for immediate execution does not trigger re-execution of the first one',function(e){var a=l.createCallbacks();o.append(s.attr("data-ab","")).append(r.attr("data-ab","")).append(i).always("a",l.invokeCallbacks(a)).always("[data-ab]",l.invokeCallbacks(a)),l.wait(1,function(){l.assertInvoked(a,2,1,0),e()})}),it("Issuing multiple additions / removals invokes registered callbacks in a reasonable amount of time",function(e){var a=1e3,n=0,s=0,r=function(){if(n+=(new Date).getTime()-s,0==a--)return t.isBelow(n,1e3),e();var r=o.find("a, em, strong, span, div"),i=0<r.length&&.5>Math.random()?function(){return r.first().remove()}:function(){return o.append("<"+["a","em","strong","span","div"][Math.round(4*Math.random())]+"/>")};s=(new Date).getTime(),i()};o.always("a, em, strong, span, div",r,r),s=(new Date).getTime(),r()})})}(jQuery,chai);
//# sourceMappingURL=tests.min.js.map